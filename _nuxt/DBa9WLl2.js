import{p as P,u as w,a as N,g as B,b as I,m as O}from"./-7Og_qXs.js";import{f as S,a4 as j,J as n,z as C,R as L,a5 as M,c as l,o as p,k as $,F as H,r as J,a6 as R,h as f}from"./BxVE6YmD.js";const T=["type","sizes","srcset"],U=["src","sizes","srcset"],V=S({__name:"NuxtPicture",props:P,emits:["load","error"],setup(d,{emit:_}){const s=d,g=j(),o=_,x=!1,i=w(),{attrs:y,options:z,modifiers:b}=N(s),v=n(()=>B(s.src)),h=n(()=>["png","webp","gif","svg"].includes(v.value)),u=n(()=>s.legacyFormat?s.legacyFormat:h.value?"png":"jpeg"),m=n(()=>{const e=s.format?.split(",")||(v.value==="svg"?["svg"]:i.options.format?.length?[...i.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(u.value)&&e.splice(e.indexOf(u.value),1),e.push(u.value),e.map(t=>{const{srcset:a,sizes:F,src:E}=i.getSizes(s.src,{...z.value,sizes:s.sizes||i.options.screens,densities:s.densities,modifiers:{...b.value,format:t}});return{src:E,type:`image/${t}`,sizes:F,srcset:a}}))}),c=n(()=>m.value[m.value.length-1]),A=n(()=>{const e={...s.imgAttrs,"data-nuxt-pic":""};for(const t in g)t in I&&!(t in e)&&(e[t]=g[t]);return e}),r=C(),k=L().isHydrating;return M(()=>{r.value&&(r.value.complete&&k&&(r.value.getAttribute("data-error")?o("error",new Event("error")):o("load",new Event("load"))),r.value.onload=e=>{o("load",e)},r.value.onerror=e=>{o("error",e)},O("nuxt-picture"))}),(e,t)=>(p(),l("picture",null,[(p(!0),l(H,null,J(m.value.slice(0,-1),a=>(p(),l("source",{key:a.src,type:a.type,sizes:a.sizes,srcset:a.srcset},null,8,T))),128)),c.value?(p(),l("img",R({key:0,ref_key:"imgEl",ref:r},{...f(y),...f(x)?{onerror:"this.setAttribute('data-error', 1)"}:{},...A.value},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,U)):$("",!0)]))}}),K=Object.assign(V,{__name:"NuxtPicture"});export{K as _};
