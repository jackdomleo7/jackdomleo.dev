import{p as w,u as P,a as B,g as I,b as N,m as S}from"./BskWyfGG.js";import{f as C,a4 as L,J as n,z as M,R as O,a5 as $,c as l,o as p,k as j,F as H,r as J,a6 as R,h as f}from"./CHVYKOZp.js";const T=["type","sizes","srcset"],U=["src","sizes","srcset"],G=C({__name:"NuxtPicture",props:w,emits:["load","error"],setup(d,{emit:y}){const s=d,g=L(),o=y,_=!1,i=P(),{attrs:z,options:x,modifiers:b}=B(s),v=n(()=>I(s.src)),h=n(()=>["png","webp","gif","svg"].includes(v.value)),u=n(()=>s.legacyFormat?s.legacyFormat:h.value?"png":"jpeg"),m=n(()=>{const e=s.format?.split(",")||(v.value==="svg"?["svg"]:i.options.format?.length?[...i.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(u.value)&&e.splice(e.indexOf(u.value),1),e.push(u.value),e.map(t=>{const{srcset:a,sizes:F,src:E}=i.getSizes(s.src,{...x.value,sizes:s.sizes||i.options.screens,densities:s.densities,modifiers:{...b.value,format:t}});return{src:E,type:`image/${t}`,sizes:F,srcset:a}}))}),c=n(()=>m.value[m.value.length-1]),A=n(()=>{const e={...s.imgAttrs,"data-nuxt-pic":""};for(const t in g)t in N&&!(t in e)&&(e[t]=g[t]);return e}),r=M(),k=O().isHydrating;return $(()=>{r.value&&(r.value.complete&&k&&(r.value.getAttribute("data-error")?o("error",new Event("error")):o("load",new Event("load"))),r.value.onload=e=>{o("load",e)},r.value.onerror=e=>{o("error",e)},S("nuxt-picture"))}),(e,t)=>(p(),l("picture",null,[(p(!0),l(H,null,J(m.value.slice(0,-1),a=>(p(),l("source",{key:a.src,type:a.type,sizes:a.sizes,srcset:a.srcset},null,8,T))),128)),c.value?(p(),l("img",R({key:0,ref_key:"imgEl",ref:r},{...f(z),...f(_)?{onerror:"this.setAttribute('data-error', 1)"}:{},...A.value},{src:c.value.src,sizes:c.value.sizes,srcset:c.value.srcset}),null,16,U)):j("",!0)]))}});export{G as _};
