import{H as s,g as _,I as g,f as O,J as j,y as I,K as P,L as C,o as f,c as m,F as L,r as M,M as $,k as b,l as H,N as J}from"./BQZeWf9W.js";function K(e){var a;(a=performance==null?void 0:performance.mark)==null||a.call(performance,"mark_feature_usage",{detail:{feature:e}})}const q={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},T=e=>{const a=s(()=>({provider:e.provider,preset:e.preset})),t=s(()=>({width:g(e.width),height:g(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),l=_(),n=s(()=>({...e.modifiers,width:g(e.width),height:g(e.height),format:e.format,quality:e.quality||l.options.quality,background:e.background,fit:e.fit}));return{options:a,attrs:t,modifiers:n}},U={...q,legacyFormat:{type:String,default:null},imgAttrs:{type:Object,default:null}};({...q});const V=["type","sizes","srcset"],D=["src","sizes","srcset"],R=O({__name:"NuxtPicture",props:U,emits:["load","error"],setup(e,{emit:a}){const t=e,l=j(),n=a,k=!1,u=_(),{attrs:z,options:A,modifiers:x}=T(t),S=s(()=>J(t.src)),w=s(()=>["png","webp","gif","svg"].includes(S.value)),c=s(()=>t.legacyFormat?t.legacyFormat:w.value?"png":"jpeg"),y=s(()=>{var v,i;const r=((v=t.format)==null?void 0:v.split(","))||(S.value==="svg"?["svg"]:(i=u.options.format)!=null&&i.length?[...u.options.format]:["webp"]);return r[0]==="svg"?[{src:t.src}]:(r.includes(c.value)&&r.splice(r.indexOf(c.value),1),r.push(c.value),r.map(h=>{const{srcset:N,sizes:B,src:E}=u.getSizes(t.src,{...A.value,sizes:t.sizes||u.options.screens,densities:t.densities,modifiers:{...x.value,format:h}});return{src:E,type:`image/${h}`,sizes:B,srcset:N}}))}),d=s(()=>y.value[y.value.length-1]),p={...t.imgAttrs,"data-nuxt-pic":""};for(const r in l)r in q&&!(r in p)&&(p[r]=l[r]);const o=I(),F=P().isHydrating;return C(()=>{o.value&&(o.value.complete&&F&&(o.value.getAttribute("data-error")?n("error",new Event("error")):n("load",new Event("load"))),o.value.onload=r=>{n("load",r)},o.value.onerror=r=>{n("error",r)},K("nuxt-picture"))}),(r,v)=>(f(),m("picture",null,[(f(!0),m(L,null,M(y.value.slice(0,-1),i=>(f(),m("source",{key:i.src,type:i.type,sizes:i.sizes,srcset:i.srcset},null,8,V))),128)),d.value?(f(),m("img",$({key:0,ref_key:"imgEl",ref:o},{...b(z),...b(k)?{onerror:"this.setAttribute('data-error', 1)"}:{},...p},{src:d.value.src,sizes:d.value.sizes,srcset:d.value.srcset}),null,16,D)):H("",!0)]))}});export{R as _};
