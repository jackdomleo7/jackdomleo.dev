[{"data":1,"prerenderedAt":464},["ShallowReactive",2],{"i-custom:chevron-down":3,"i-custom:j-icon":8,"i-custom:github":12,"i-custom:codepen":16,"i-custom:linkedin":18,"/blog/2024/how-to-protect-state-in-pinia":21,"i-custom:twitter":459,"i-custom:link":461},{"left":4,"top":4,"width":5,"height":5,"rotate":4,"vFlip":6,"hFlip":6,"body":7},0,24,false,"\u003Cg fill=\"currentColor\">\u003Cpath fill=\"none\" d=\"M24 24H0V0h24v24z\" opacity=\".87\"/>\u003Cpath d=\"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z\"/>\u003C/g>",{"left":4,"top":4,"width":9,"height":10,"rotate":4,"vFlip":6,"hFlip":6,"body":11},282.26,266.99,"\u003Cpath fill=\"#fff\" d=\"M226.39 155.22a55.39 55.39 0 0 0-29.46 8.59V0h-95.89v166.85c0 1.28-.08 2.3-.15 3h-.23s-1.22-1.26-2.37-5.52l-8.56-31.77L0 169.49l7.77 25.26c6.55 21.25 18.52 38.3 35.58 50.66 16.89 12.23 36.67 18.44 58.78 18.44a103.8 103.8 0 0 0 35.66-6.11 87.32 87.32 0 0 0 31.07-19.34 87 87 0 0 0 5.66-6.84 55.83 55.83 0 1 0 51.87-76.38Z\"/>\u003Cpath fill=\"#000\" d=\"M55.11 229.18c13.39 9.71 29.2 14.62 47 14.62a83.58 83.58 0 0 0 28.79-4.9 67.21 67.21 0 0 0 24-14.9 70.87 70.87 0 0 0 16.11-24.41c3.88-9.57 5.85-20.68 5.85-33V20.09h-55.75v146.76c0 7.89-1.73 13.89-5.15 17.82-3.19 3.69-7.59 5.4-13.85 5.4-5.81 0-10.49-1.54-14.34-4.74s-7-8.58-8.9-15.73l-2.62-9.73-51.68 21.27 2.38 7.74c5.26 17.01 14.75 30.56 28.16 40.3Z\"/>\u003Cpath fill=\"var(--color-accent, #000)\" d=\"M226.39 246.89a35.79 35.79 0 1 0-35.79-35.79 35.79 35.79 0 0 0 35.79 35.79Z\"/>",{"left":4,"top":4,"width":13,"height":14,"rotate":4,"vFlip":6,"hFlip":6,"body":15},496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z\"/>",{"left":4,"top":4,"width":14,"height":14,"rotate":4,"vFlip":6,"hFlip":6,"body":17},"\u003Cpath fill=\"currentColor\" d=\"m502.285 159.704-234-156c-7.987-4.915-16.511-4.96-24.571 0l-234 156C3.714 163.703 0 170.847 0 177.989v155.999c0 7.143 3.714 14.286 9.715 18.286l234 156.022c7.987 4.915 16.511 4.96 24.571 0l234-156.022c6-3.999 9.715-11.143 9.715-18.286V177.989c-.001-7.142-3.715-14.286-9.716-18.285zM278 63.131l172.286 114.858-76.857 51.429L278 165.703V63.131zm-44 0v102.572l-95.429 63.715-76.857-51.429L234 63.131zM44 219.132l55.143 36.857L44 292.846v-73.714zm190 229.715L61.714 333.989l76.857-51.429L234 346.275v102.572zm22-140.858-77.715-52 77.715-52 77.715 52-77.715 52zm22 140.858V346.275l95.429-63.715 76.857 51.429L278 448.847zm190-156.001-55.143-36.857L468 219.132v73.714z\"/>",{"left":4,"top":4,"width":19,"height":14,"rotate":4,"vFlip":6,"hFlip":6,"body":20},448,"\u003Cpath fill=\"currentColor\" d=\"M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z\"/>",{"id":22,"title":23,"body":24,"description":447,"extension":448,"meta":449,"modified_time":450,"navigation":129,"path":451,"published_time":452,"seo":453,"sitemap":454,"stem":455,"tags":456,"__hash__":458},"article/blog/2024/how-to-protect-state-in-pinia.md","How to protect state in Pinia",{"type":25,"value":26,"toc":445},"minimark",[27,54,61,64,67,70,415,425,428,441],[28,29,30,37,38,43,44,49,50],"p",{},[31,32,36],"a",{"href":33,"rel":34},"https://pinia.vuejs.org/",[35],"nofollow","Pinia"," is a relatively new state management tool for the Vue ecosystem. It is the new preferred state management tool recommended by the Vue core team replacing Vuex. Compared to ",[31,39,42],{"href":40,"rel":41},"https://vuex.vuejs.org/",[35],"Vuex",", Pinia is type-safe by default (",[31,45,48],{"href":46,"rel":47},"https://github.com/paroi-tech/direct-vuex",[35],"direct-vuex"," was needed to make Vuex type-safe), extremely lightweight, and modular by design (meaning you can create multiple stores instead of multiple modules inside one store, which optimises performance). Similar to Vuex, Pinia has state, computed properties (getters) and methods (mutations and actions). ",[51,52,53],"em",{},"Read more about Pinia and its usage to understand the similarities and differences between Pinia and Vuex.",[28,55,56,57],{},"Vuex's state is automatically protected, whereas Pinia's state is not. In Vuex, you could not directly edit the state, to do so you needed a mutation method that would edit or \"mutate\" the state for you. If you tried editing the state directly in Vuex, you would be faced with the following error message, ",[58,59,60],"code",{},"\"Error: [vuex] do not mutate vuex store state outside mutation handlers.\"",[28,62,63],{},"But with Pinia, the state is exposed and can be mutated willy nilly from anywhere within your application. In a lot of cases, this is fine and actually makes state management a lot easier and simpler because in these cases there is no need for a mutation method whose sole purpose is to update a state property with the value you passed to the mutation method.",[28,65,66],{},"In some cases though, this might not be ideal. For example, we are building a rugby game in Vue (it's just an example, go with it). Unlike with football (or soccer for you Americans) where the scoring system increments by 1 whenever a goal is scored, rugby's scoring system increases by a different number depending on how those points were scored. 5 points for a try, 3 points for a penalty, 2 points for a conversion, and 3 points for a drop goal.",[28,68,69],{},"We want to be able to protect the score state property by only allowing it to be mutated in a specific way. We can easily do this by creating an exposed computed property that returns the state, and not exposing the state property.",[71,72,77],"pre",{"className":73,"code":74,"language":75,"meta":76,"style":76},"language-ts shiki shiki-themes min-dark","import { defineStore } from 'pinia';\nimport { ref, computed } from 'vue';\n\nexport const useRugbyStore = defineStore('rugbyStory', () => {\n  const _score = ref\u003Cnumber>(0);\n\n  const score = computed(() => _score.value);\n\n  function scorePoints(type: 'try'|'penalty'|'conversion'|'drop goal'): void {\n    switch (type) {\n      case 'try':\n        _score.value += 5;\n        break;\n      case 'penalty':\n      case 'drop goal':\n        _score.value += 3;\n        break;\n      case 'conversion':\n        _score.value += 2;\n        break;\n    }\n  }\n\n  return { score, scorePoints };\n})\n","ts","",[58,78,79,102,124,131,164,191,196,216,221,262,271,282,299,307,317,327,341,348,358,372,379,385,391,396,409],{"__ignoreMap":76},[80,81,84,88,92,95,99],"span",{"class":82,"line":83},"line",1,[80,85,87],{"class":86},"snl16","import",[80,89,91],{"class":90},"svObZ"," { defineStore } ",[80,93,94],{"class":86},"from",[80,96,98],{"class":97},"s9osk"," 'pinia'",[80,100,101],{"class":90},";\n",[80,103,105,107,110,114,117,119,122],{"class":82,"line":104},2,[80,106,87],{"class":86},[80,108,109],{"class":90}," { ref",[80,111,113],{"class":112},"soy-K",",",[80,115,116],{"class":90}," computed } ",[80,118,94],{"class":86},[80,120,121],{"class":97}," 'vue'",[80,123,101],{"class":90},[80,125,127],{"class":82,"line":126},3,[80,128,130],{"emptyLinePlaceholder":129},true,"\n",[80,132,134,137,140,144,147,150,153,155,158,161],{"class":82,"line":133},4,[80,135,136],{"class":86},"export",[80,138,139],{"class":86}," const",[80,141,143],{"class":142},"sDLfK"," useRugbyStore",[80,145,146],{"class":86}," =",[80,148,149],{"class":90}," defineStore(",[80,151,152],{"class":97},"'rugbyStory'",[80,154,113],{"class":112},[80,156,157],{"class":90}," () ",[80,159,160],{"class":86},"=>",[80,162,163],{"class":90}," {\n",[80,165,167,170,173,175,178,181,184,188],{"class":82,"line":166},5,[80,168,169],{"class":86},"  const",[80,171,172],{"class":142}," _score",[80,174,146],{"class":86},[80,176,177],{"class":90}," ref\u003C",[80,179,180],{"class":142},"number",[80,182,183],{"class":90},">(",[80,185,187],{"class":186},"splxs","0",[80,189,190],{"class":90},");\n",[80,192,194],{"class":82,"line":193},6,[80,195,130],{"emptyLinePlaceholder":129},[80,197,199,201,204,206,209,211,213],{"class":82,"line":198},7,[80,200,169],{"class":86},[80,202,203],{"class":142}," score",[80,205,146],{"class":86},[80,207,208],{"class":90}," computed(() ",[80,210,160],{"class":86},[80,212,172],{"class":142},[80,214,215],{"class":90},".value);\n",[80,217,219],{"class":82,"line":218},8,[80,220,130],{"emptyLinePlaceholder":129},[80,222,224,227,230,233,236,239,242,244,247,249,252,255,257,260],{"class":82,"line":223},9,[80,225,226],{"class":86},"  function",[80,228,229],{"class":90}," scorePoints(type",[80,231,232],{"class":86},":",[80,234,235],{"class":97}," 'try'",[80,237,238],{"class":86},"|",[80,240,241],{"class":97},"'penalty'",[80,243,238],{"class":86},[80,245,246],{"class":97},"'conversion'",[80,248,238],{"class":86},[80,250,251],{"class":97},"'drop goal'",[80,253,254],{"class":90},")",[80,256,232],{"class":86},[80,258,259],{"class":142}," void",[80,261,163],{"class":90},[80,263,265,268],{"class":82,"line":264},10,[80,266,267],{"class":86},"    switch",[80,269,270],{"class":90}," (type) {\n",[80,272,274,277,279],{"class":82,"line":273},11,[80,275,276],{"class":86},"      case",[80,278,235],{"class":97},[80,280,281],{"class":90},":\n",[80,283,285,288,291,294,297],{"class":82,"line":284},12,[80,286,287],{"class":142},"        _score",[80,289,290],{"class":90},".value ",[80,292,293],{"class":86},"+=",[80,295,296],{"class":186}," 5",[80,298,101],{"class":90},[80,300,302,305],{"class":82,"line":301},13,[80,303,304],{"class":86},"        break",[80,306,101],{"class":90},[80,308,310,312,315],{"class":82,"line":309},14,[80,311,276],{"class":86},[80,313,314],{"class":97}," 'penalty'",[80,316,281],{"class":90},[80,318,320,322,325],{"class":82,"line":319},15,[80,321,276],{"class":86},[80,323,324],{"class":97}," 'drop goal'",[80,326,281],{"class":90},[80,328,330,332,334,336,339],{"class":82,"line":329},16,[80,331,287],{"class":142},[80,333,290],{"class":90},[80,335,293],{"class":86},[80,337,338],{"class":186}," 3",[80,340,101],{"class":90},[80,342,344,346],{"class":82,"line":343},17,[80,345,304],{"class":86},[80,347,101],{"class":90},[80,349,351,353,356],{"class":82,"line":350},18,[80,352,276],{"class":86},[80,354,355],{"class":97}," 'conversion'",[80,357,281],{"class":90},[80,359,361,363,365,367,370],{"class":82,"line":360},19,[80,362,287],{"class":142},[80,364,290],{"class":90},[80,366,293],{"class":86},[80,368,369],{"class":186}," 2",[80,371,101],{"class":90},[80,373,375,377],{"class":82,"line":374},20,[80,376,304],{"class":86},[80,378,101],{"class":90},[80,380,382],{"class":82,"line":381},21,[80,383,384],{"class":90},"    }\n",[80,386,388],{"class":82,"line":387},22,[80,389,390],{"class":90},"  }\n",[80,392,394],{"class":82,"line":393},23,[80,395,130],{"emptyLinePlaceholder":129},[80,397,398,401,404,406],{"class":82,"line":5},[80,399,400],{"class":86},"  return",[80,402,403],{"class":90}," { score",[80,405,113],{"class":112},[80,407,408],{"class":90}," scorePoints };\n",[80,410,412],{"class":82,"line":411},25,[80,413,414],{"class":90},"})\n",[28,416,417,418,421,422],{},"In the example above, ",[58,419,420],{},"_score"," (annotated prefixed with an underscore to show it is internal) can be read via the score computed property, but cannot be mutated directly. Since score is a computed property, Vue does not allow its value to be changed, if you try editing the value of score, you will get the following TypeScript error, ",[58,423,424],{},"\"Cannot assign to \"score\" because it is a read-only property.\"",[28,426,427],{},"One caveat to this though is that score or _score will never appear in Pinia's global state or in the Vue devtools Pinia panel, so keep this in mind.",[28,429,430,431,436,437,440],{},"I feel this is quite a simple, neat, easy-to-maintain, and type-safe method of protecting Pinia state. I have found other methods of protecting state such as ",[31,432,435],{"href":433,"rel":434},"https://github.com/vuejs/pinia/issues/58#issuecomment-983284955",[35],"this example"," using Vue's ",[58,438,439],{},"readonly()"," method but I didn't find this to be type-safe or very nice to use.",[442,443,444],"style",{},"html pre.shiki code .snl16, html code.shiki .snl16{--shiki-default:#F97583}html pre.shiki code .svObZ, html code.shiki .svObZ{--shiki-default:#B392F0}html pre.shiki code .s9osk, html code.shiki .s9osk{--shiki-default:#FFAB70}html pre.shiki code .soy-K, html code.shiki .soy-K{--shiki-default:#BBBBBB}html pre.shiki code .sDLfK, html code.shiki .sDLfK{--shiki-default:#79B8FF}html pre.shiki code .splxs, html code.shiki .splxs{--shiki-default:#F8F8F8}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":76,"searchDepth":104,"depth":104,"links":446},[],"Pinia, unlike Vuex, allows the state to be mutated directly, but sometimes we want to protect the state from being changed willy-nilly.","md",{},null,"/blog/2024/how-to-protect-state-in-pinia","2024-04-07T00:00:00.000Z",{"title":23,"description":447},{"loc":451},"blog/2024/how-to-protect-state-in-pinia",[457],"Vue","i280NQq3kcJDpVZ7kGglmPpROtZ7U3TSedgANV2B0rM",{"left":4,"top":4,"width":5,"height":5,"rotate":4,"vFlip":6,"hFlip":6,"body":460},"\u003Cpath d=\"M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z\"/>",{"left":4,"top":4,"width":462,"height":14,"rotate":4,"vFlip":6,"hFlip":6,"body":463},640,"\u003Cpath d=\"M579.8 267.7c56.5-56.5 56.5-148 0-204.5-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6 31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0l112.3-112.3zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5 50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5l112.2-112.3c31.5-31.5 82.5-31.5 114 0 27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z\"/>",1755463251757]